<% provide(:title, "The Grid") %>
<div class="page" id="blog-page" role="main">
  <h2><%= @grid_title %> (<%= @projects.count %>)</h2>
  <%= link_to "New", new_project_path %><br /><br />
  <script type="text/javascript" async="">
    function toggleTable1() {
    var lTable = document.getElementById("projectGridTable");
    lTable.style.display = (lTable.style.display == "table") ? "none" : "table";}
  </script>
  <table id="projectGridTable" class="projectGridTable">
    <thead>
      <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Genre</th>
        <th>Editor</th>
        <th>Proofreader</th>
        <th>Project Manager</th>
        <th>Marketing Manager</th>
        <th>Cover Designer</th>
        <th>Imprint</th>
        <th>Production</th>
        <th>Design</th>
        <th>Marketing</th>
        <th>Teamroom Link</th>
      </tr>
    </thead>

    <% @projects.each do | row | %>
    <tr>
      <td><nobr><%= link_to row.title, row.project %></nobr>
      <% if can? :edit, row.project %>
      | <%= link_to "Edit", edit_project_path(row.project)  %>
      <% end%>
      <% if can? :delete, row.project %>
      | <%= link_to "Delete", project_path(row.project), method: :delete, data: {confirm: "Are you sure you want to delete this project?"}%><br />
      <% end %>
      </td>
      <td><%= row.author?? row.author : "-" %></td>
      <td><%= row.genre?? row.genre : "-" %></td>
      <td><%= row.editor?? row.editor : "-" %></td>
      <td><%= row.proofreader?? row.proofreader : "-" %></td>
      <td><%= row.project_manager?? row.project_manager : "-" %></td>
      <td><%= row.book_manager?? row.book_manager : "-" %></td>
      <td><%= row.cover_designer?? row.cover_designer : "-" %></td>
      <td><%= row.imprint?? row.imprint : "-" %></td>
      <td><%= row.production_task_name?? row.production_task_name : "-" %></td>
      <td><%= row.design_task_name?? row.design_task_name : "-" %></td>
      <td><%= row.marketing_task_name?? row.marketing_task_name : "-" %></td>
      <td><%= row.teamroom_link?? link_to("Teamroom Link", row.teamroom_link) : '-' %></td>
    </tr>
    <% end %>

  </table>
  <script>
  $("#projectGridTable").DataTable({
        "pageLength" : 100
  });
  </script>
  <br />
</div>
