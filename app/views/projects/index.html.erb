<% provide(:title, "The Grid") %>
<div class="page" id="blog-page" role="main">
  <h2>The Grid - All Book Projects</h2><br />
  <%= link_to "New", new_project_path %><br /><br />
  <h2>Manuscript (Pre-Edit) (32)  <a id="tableSwitch" onclick="toggleTable1();" href="#" style="text-decoration:none;"><img src="https://teamtrope.com/wp-content/uploads/2014/02/expand_collapse_plus.gif"><img src="https://teamtrope.com/wp-content/uploads/2014/02/expand_collapse_minus.gif"></a></h2>

  <script type="text/javascript" async="">
    function toggleTable1() {
    var lTable = document.getElementById("Table1");
    lTable.style.display = (lTable.style.display == "table") ? "none" : "table";}
  </script>
  <table id="Table1" class="sortable">
    <tr>
      <th>Title</th>
      <th>Author</th>
      <th>Genre</th>
      <th>Editor</th>
      <th>Proofreader</th>
      <th>Project Manager</th>
      <th>Marketing Manager</th>
      <th>Cover Designer</th>
      <th>Teamroom Link</th>
    </tr>

    <% @projects.each do | project | %>
      <tr>
        <td class="book-title">
          <%= link_to project.title, project %>
          <% if can? :edit, project %>
          | <%= link_to "Edit", edit_project_path(project)  %>
          <% end%>
          <% if can? :delete, project %>
          | <%= link_to "Delete", project_path(project), method: :delete, data: {confirm: "Are you sure you want to delete this project?"}%><br />
          <% end %>
        </td>
        <td><%= (project.authors.try(:first).try(:member).nil?) ? 'N/A' : project.authors.first.member.name %></td>
        <td><%= project.genres.map(&:name).join(', ') %></td>
        <td><%= (project.editors.try(:first).try(:member).nil?) ? 'N/A' : project.editors.first.member.name %></td>
        <td><%= (project.proof_readers.try(:first).try(:member).nil?) ? 'N/A' : project.proof_readers.first.member.name %></td>
        <td><%= (project.project_managers.try(:first).try(:member).nil?) ? 'N/A' : project.project_managers.first.member.name %></td>
        <td><%= (project.book_managers.try(:first).try(:member).nil?) ? 'N/A' : project.book_managers.first.member.name %></td>
        <td><%= (project.cover_designers.try(:first).try(:member).nil?) ? 'N/A' : project.cover_designers.first.member.name %></td>
        <td><% if !project.teamroom_link.empty? %><a href="<%= project.teamroom_link %>">Teamroom Link</a><% else %><% end %></td>
      </tr>
    <% end %>
  </table>
  <br />
  <h2>Total: (<%= @projects.count %>)</h2>
</div>
